
$apiUrl = "https://members-api.parliament.uk/api/Members/Search"
$response = Invoke-RestMethod -Uri $apiUrl -Method Get
$members = $response.items

$members | ForEach-Object { $_.value | Select-Object id, 
  nameListAs, 
  latestParty.name, 
  gender, 
  latestHouseMembership.membershipFrom,
  latestHouseMembership.membershipStartDate,
  latestHouseMembership.membershipEndDate,
  latestHouseMembership.membershipEndReason,
  latestHouseMembership.membershipEndReasonNotes,
  latestHouseMembership.membershipStatus.statusIsActive,
  latestHouseMembership.membershipStatus.statusDescription
  
} 
